define(["require","exports","module","model/module","api/crawler"],function(e,t){function i(e,t){this.name=e,this.list=[],this.options=$.extend({},{mute:!1,prefix:this.name+":"},t)}var n=e("model/module"),r=e("api/crawler");return i.fn=i.prototype,i.fn.find=function(e){var t=0,n=this.list.length;for(;t<n;t++)if(this.list[t].isSame(e))return t;return-1},i.fn.get=function(e){return typeof e=="number"&&e>=0&&e<this.list.length?this.list[e]:typeof e=="string"||typeof e=="object"?this.get(this.find(e)):null},i.fn.add=function(e,t){t=$.extend({},this.options,t),this.find(e)===-1?typeof e=="object"?this._add(e,t):typeof e=="string"&&r.crawl(e,$.proxy(function(e){this._add(new n(e),t)},this)):t.mute||$.publish(t.prefix+"addOne:duplicated",this.get(e))},i.fn.populate=function(e,t){var r,i=e.length;for(r=0;r<i;r++)this._add(new n(e[r].data,e[r].status),t)},i.fn._add=function(e,t){var n=this.duplicated("examDate",e.get("examDate"));t=$.extend({},this.options,t),e.set("list",this.name),this.list.push(e),$.publish("module:save"),t.mute||($.publish(t.prefix+"addOne",[e]),n>=0&&e.get("examDate").indexOf("No Exam")<0&&$.publish(t.prefix+"duplicatedExamDate",[this.get(n),e]))},i.fn.remove=function(e,t){var n;return t=$.extend({},this.options,t),typeof e=="number"&&e>=0&&e<this.list.length?(n=this.list.splice(e,1)[0],$.publish("module:save"),t.mute||$.publish(t.prefix+"removeOne",[n]),n):typeof e=="string"||typeof e=="object"?this.remove(this.find(e),t):null},i.fn.clean=function(e){e=$.extend({},this.options,e),this.list=[],$.publish("module:save"),e.mute||$.publish(e.prefix+"clean")},i.fn.length=function(){return this.list.length},i.fn.duplicated=function(e,t){if(t==="-")return-1;var n,r=this.list.length;for(n=0;n<r;n++)if(this.list[n].get(e)===t)return n;return-1},i.fn.inSequence=function(e){var t=[],n,r=e.length;for(n=0;n<r;n++)t.push(this.get(e[n]));this.list=t},i.fn.toJSON=function(){var e=[],t,n=this.list.length;for(t=0;t<n;t++)e.push(this.list[t].toJSON());return e},i});